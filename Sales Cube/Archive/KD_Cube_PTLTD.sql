   SELECT   invhead.recid,
            'PTLTD' AS source,
            '300' AS company,
            'DISTRIBUTION' AS segment,
            'PTLTD' AS corporate_form,
            'ROW' AS region_code,
            invhead.territory AS salesman_code,
            'Paltop LTD Sales' AS salesman_name,
            NULL AS order_salesman_code,
            NULL AS commission_receiver,
            NULL AS commission_receiver_name,
            NULL AS association_no,
            invhead.customerno AS customer_id,
            invhead.customer AS customer_name,
            'PLTD' || substr(invhead.invoiceno,3,7) AS order_id,
            NULL AS rma_id,
            NULL AS rma_line,
            NULL AS market_code,
            NULL AS pay_term_id,
            'ILS' as order_currency,
            TO_CHAR(invhead.invoicedate,'YYYY') AS order_entry_year,
            TO_CHAR(invhead.invoicedate,'Q') AS order_entry_quarter,
            TO_CHAR(invhead.invoicedate,'MM') AS order_entry_month,
            TO_DATE(trunc(invhead.invoicedate),'MM/DD/YYYY') AS order_entry_date,
            TO_CHAR(invhead.invoicedate,'YYYY') AS invoice_year,
            TO_CHAR(invhead.invoicedate,'Q') AS invoice_quarter,
            TO_CHAR(invhead.invoicedate,'MM') AS invoice_month,
            TO_DATE(trunc(invhead.invoicedate),'MM/DD/YYYY') AS invoice_date,
            invhead.invoiceno AS invoice_id,
            TO_CHAR(invhead.line_item_no) AS item_id,
            NVL(inventpart.part_product_code,'IMPL') AS part_product_code,
            NVL(inventpart.part_product_family,'OTHER') AS part_product_family,
            NVL(inventpart.second_commodity,'OTHER') AS second_commodity,
            invhead.itemno as catalog_no,
            NVL(inventpart.description,invhead.item) as catalog_desc,
            invhead.qty as invoiced_qty,
            Invhead.current_list_price,
            invhead.amt_ils/nullif(invhead.qty,0) AS unit_price,
            invhead.amt_ils as total_price,
            invhead.rate_usd AS currency_rate,
            0 AS tax_amount,
            NULL as tax_code
    
     FROM   kd_ptltd_raw_data invhead
LEFT JOIN   inventory_part inventpart
       ON   UPPER(invhead.itemno) = UPPER(inventpart.part_no)
      AND   '100' = inventpart.contract