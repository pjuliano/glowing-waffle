SELECT                sc.invoice_salesman_code,                sc.invoice_salesman_name,                sc.order_id,                SUM(sc.total_price_usd) AS total_price,                SUM(sc.invoiced_qty * sc.current_list_price) AS total_at_list,                SUM(DECODE(part_product_family,'FREIGHT',sh.line_package_charge,sc.invoiced_qty * ipucs.inventory_value)) AS total_cost,                ROUND((SUM(sc.total_price_usd) - SUM(DECODE(part_product_family,'FREIGHT',sh.line_package_charge,sc.invoiced_qty * ipucs.inventory_value))) / nullif(SUM(sc.total_price_usd),0) * 100,2) AS order_marginFROM                kd_sales_cube sc                LEFT JOIN inventory_part_unit_cost_sum ipucs                    ON sc.company = ipucs.contract                        AND sc.catalog_no = ipucs.part_no                LEFT JOIN ps_freight_info_co sh                    ON order_id = line_order_noWHERE                invoice_year = 2019                    AND sales_market = 'NORAM'                    AND ipucs.inventory_value != '9999'HAVING                SUM(DECODE(part_product_family,'FREIGHT',sh.line_package_charge,sc.invoiced_qty * ipucs.inventory_value)) > 0GROUP BY                sc.invoice_salesman_code,                sc.invoice_salesman_name,                sc.order_id